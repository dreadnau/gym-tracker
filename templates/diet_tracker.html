{% extends "base.html" %}

{% block content %}

<h2>ğŸ¥— Diet Discipline Tracker</h2>

{% if weekly_avg == 0 %}

<div style="margin:10px 0; padding:10px; background:#e0e0e0; border-radius:10px;">
ğŸ“Š <b>Weekly Average Calories:</b> No data yet
</div>

{% else %}

<div style="margin:10px 0; padding:10px; background:#d4f8d4; border-radius:10px;">
ğŸ”¥ <b>Weekly Average Calories:</b> {{ weekly_avg }} kcal
</div>

{% endif %}

<p>Consistency beats motivation. Stay locked in ğŸ”’</p>

<hr>

<h4>Add Today's Calories</h4>

<form action="/save-diet" method="POST">

    <label>Calories Consumed Today</label><br>
    <input type="number" name="calories" required style="width:100%;padding:8px;"><br><br>

    <label>Your Maintenance Calories</label><br>
    <input type="number" name="maintenance" required style="width:100%;padding:8px;"><br><br>

    <label>
        <input type="checkbox" name="cheat"> Cheat Meal Today ğŸ•
    </label><br><br>

    <button class="btn">Save Day</button>

</form>

<hr>

<h3>ğŸ”¥ Transformation Log</h3>

<table class="table">

<tr>
    <th>Day</th>
    <th>Date</th>
    <th>Status</th>
    <th>Calories</th>
    <th>Maintenance +/-</th>
    <th>Cheat</th>
    <th>Action</th>
</tr>

{% for log in logs %}

<tr {% if log.cheat_meal %} style="background-color:#ffe5e5;" {% endif %}>

    <td>Day {{ log.day_number }}</td>

    <td>{{ log.date | replace("-", " ") }}</td>

    <td>
        {% if log.calorie_diff <= 0 %}
            âœ… On Track
        {% else %}
            âš  Over Target
        {% endif %}
    </td>

    <td>{{ log.calories }}</td>

    <td>
        {% if log.calorie_diff <= 0 %}
            ğŸ”¥ {{ log.calorie_diff }}
        {% else %}
            +{{ log.calorie_diff }}
        {% endif %}
    </td>

    <td>
        {% if log.cheat_meal %}
            <span style="color:red; font-weight:bold;">ğŸ” Cheat</span>
        {% else %}
            <span style="color:green;">ğŸ¥— Clean</span>
        {% endif %}
    </td>

    <!-- EDIT BUTTON COLUMN -->
    <td>
        <a href="/edit-diet/{{ log.id }}" class="btn" style="padding:6px 10px;">
            âœ Edit
        </a>
    </td>

</tr>

{% endfor %}

</table>

{% endblock %}
